{"data":{"site":{"siteMetadata":{"title":"Another Chris","author":"Chris Small"}},"markdownRemark":{"id":"d28ea2d2-49af-5948-8e1b-989099954ac2","excerpt":"This example is borrowed from a newsgroup post, apologies to whoever should take the credit but I lost the original url. It’s a basic console application that…","html":"<p>This example is borrowed from a newsgroup post, apologies to whoever should take the credit but I lost the original url. It’s a basic console application that prints out access lists and groups lists using WMI for the windows directory.</p>\n<!--more-->\n<p>If you’d rather use the System.DirectoryServices namespace then there is a good example in <a href=\"http://www.bitbucket.org/yetanotherchris/roadkill/src/4b864a2a214f/Roadkill.Core/Domain/Managers/Security/ActiveDirectoryUserManager.cs\">the roadkill source</a>.</p>\n<p><div id=\"gist4953130\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">using</span> <span class=\"pl-en\">System</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">using</span> <span class=\"pl-en\">System</span>.<span class=\"pl-en\">Management</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">using</span> <span class=\"pl-en\">System</span>.<span class=\"pl-en\">Collections</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">class</span> <span class=\"pl-en\">Tester</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">    [<span class=\"pl-en\">Flags</span>]</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-gistfile1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">enum</span> <span class=\"pl-en\">Mask</span> : <span class=\"pl-k\">uint</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-gistfile1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-gistfile1-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_READ_DATA</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000001</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-gistfile1-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_WRITE_DATA</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000002</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-gistfile1-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_APPEND_DATA</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000004</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-gistfile1-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_READ_EA</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000008</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-gistfile1-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_WRITE_EA</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000010</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-gistfile1-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_EXECUTE</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000020</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-gistfile1-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_DELETE_CHILD</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000040</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-gistfile1-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_READ_ATTRIBUTES</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000080</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-gistfile1-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">FILE_WRITE_ATTRIBUTES</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00000100</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-gistfile1-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">DELETE</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00010000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-gistfile1-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">READ_CONTROL</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00020000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-gistfile1-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">WRITE_DAC</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00040000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-gistfile1-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">WRITE_OWNER</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00080000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-gistfile1-cs-LC23\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">SYNCHRONIZE</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x00100000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-gistfile1-cs-LC24\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">ACCESS_SYSTEM_SECURITY</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x01000000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-gistfile1-cs-LC25\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">MAXIMUM_ALLOWED</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x02000000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-gistfile1-cs-LC26\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">GENERIC_ALL</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x10000000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-gistfile1-cs-LC27\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">GENERIC_EXECUTE</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x20000000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-gistfile1-cs-LC28\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">GENERIC_WRITE</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x40000000</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-gistfile1-cs-LC29\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">GENERIC_READ</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0x80000000</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-gistfile1-cs-LC30\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-gistfile1-cs-LC31\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-gistfile1-cs-LC32\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">Main</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-gistfile1-cs-LC33\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-gistfile1-cs-LC34\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">try</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-gistfile1-cs-LC35\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-gistfile1-cs-LC36\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-en\">ManagementObject</span> <span class=\"pl-smi\">lfs</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-en\">ManagementObject</span>(<span class=\"pl-s\"><span class=\"pl-pds\">@&quot;</span>Win32_LogicalFileSecuritySetting.Path=&#39;c:\\\\windows&#39;<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-gistfile1-cs-LC37\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-gistfile1-cs-LC38\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Dump all trustees (this includes owner)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-gistfile1-cs-LC39\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">foreach</span> (<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">b</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">lfs</span>.<span class=\"pl-en\">GetRelated</span>())</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-gistfile1-cs-LC40\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Trustees {0} is {1}<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">b</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AccountName<span class=\"pl-pds\">&quot;</span></span>], <span class=\"pl-smi\">b</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SID<span class=\"pl-pds\">&quot;</span></span>]);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-gistfile1-cs-LC41\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-gistfile1-cs-LC42\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Get the security descriptor for this object</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-gistfile1-cs-LC43\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">outP</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">lfs</span>.<span class=\"pl-en\">InvokeMethod</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GetSecurityDescriptor<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-c1\">null</span>, <span class=\"pl-c1\">null</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-gistfile1-cs-LC44\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">if</span> (((<span class=\"pl-k\">uint</span>)(<span class=\"pl-smi\">outP</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ReturnValue<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>)) <span class=\"pl-k\">==</span> <span class=\"pl-c1\">0</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-gistfile1-cs-LC45\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-gistfile1-cs-LC46\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">Descriptor</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>)(<span class=\"pl-smi\">outP</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Descriptor<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-gistfile1-cs-LC47\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">DumpDescriptor</span>(<span class=\"pl-smi\">Descriptor</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-gistfile1-cs-LC48\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">ManagementBaseObject</span>[] <span class=\"pl-smi\">DaclObject</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>[])(<span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Dacl<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-gistfile1-cs-LC49\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">DumpACEs</span>(<span class=\"pl-smi\">DaclObject</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-gistfile1-cs-LC50\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">OwnerObject</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>)(<span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Owner<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-gistfile1-cs-LC51\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">DumpOwnerProperties</span>(<span class=\"pl-smi\">OwnerObject</span>.<span class=\"pl-smi\">Properties</span>); <span class=\"pl-c\"><span class=\"pl-c\">//</span> Show owner properies</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-gistfile1-cs-LC52\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">GroupObject</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>)(<span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Group<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-gistfile1-cs-LC53\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">DumpGroup</span>(<span class=\"pl-smi\">GroupObject</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-gistfile1-cs-LC54\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">ManagementBaseObject</span>[] <span class=\"pl-smi\">SaclObject</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>[])(<span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SACL<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-gistfile1-cs-LC55\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-en\">DumpSacl</span>(<span class=\"pl-smi\">SaclObject</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-gistfile1-cs-LC56\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-gistfile1-cs-LC57\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-gistfile1-cs-LC58\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">catch</span> (<span class=\"pl-en\">Exception</span> <span class=\"pl-smi\">e</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"></td>\n        <td id=\"file-gistfile1-cs-LC59\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"></td>\n        <td id=\"file-gistfile1-cs-LC60\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">e</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"></td>\n        <td id=\"file-gistfile1-cs-LC61\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"></td>\n        <td id=\"file-gistfile1-cs-LC62\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">ReadLine</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"></td>\n        <td id=\"file-gistfile1-cs-LC63\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"></td>\n        <td id=\"file-gistfile1-cs-LC64\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"></td>\n        <td id=\"file-gistfile1-cs-LC65\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">DumpDescriptor</span>(<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">Descriptor</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"></td>\n        <td id=\"file-gistfile1-cs-LC66\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"></td>\n        <td id=\"file-gistfile1-cs-LC67\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">/*</span> Win32_SecurityDescriptor</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"></td>\n        <td id=\"file-gistfile1-cs-LC68\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\tControlFlags</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"></td>\n        <td id=\"file-gistfile1-cs-LC69\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\tDACL</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"></td>\n        <td id=\"file-gistfile1-cs-LC70\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\tGroup</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"></td>\n        <td id=\"file-gistfile1-cs-LC71\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\tOwner</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"></td>\n        <td id=\"file-gistfile1-cs-LC72\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\tSACL</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"></td>\n        <td id=\"file-gistfile1-cs-LC73\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">\t\t<span class=\"pl-c\">*/</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"></td>\n        <td id=\"file-gistfile1-cs-LC74\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">ClassPath</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"></td>\n        <td id=\"file-gistfile1-cs-LC75\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">foreach</span> (<span class=\"pl-en\">PropertyData</span> <span class=\"pl-smi\">pd</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">Descriptor</span>.<span class=\"pl-smi\">Properties</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"></td>\n        <td id=\"file-gistfile1-cs-LC76\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">pd</span>.<span class=\"pl-smi\">Name</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"></td>\n        <td id=\"file-gistfile1-cs-LC77\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"></td>\n        <td id=\"file-gistfile1-cs-LC78\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"></td>\n        <td id=\"file-gistfile1-cs-LC79\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">DumpACEs</span>(<span class=\"pl-en\">ManagementBaseObject</span>[] <span class=\"pl-smi\">DaclObject</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L80\" class=\"blob-num js-line-number\" data-line-number=\"80\"></td>\n        <td id=\"file-gistfile1-cs-LC80\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L81\" class=\"blob-num js-line-number\" data-line-number=\"81\"></td>\n        <td id=\"file-gistfile1-cs-LC81\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> ACE masks see: winnt.h</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L82\" class=\"blob-num js-line-number\" data-line-number=\"82\"></td>\n        <td id=\"file-gistfile1-cs-LC82\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">string</span>[] <span class=\"pl-smi\">filedesc</span> <span class=\"pl-k\">=</span> </td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L83\" class=\"blob-num js-line-number\" data-line-number=\"83\"></td>\n        <td id=\"file-gistfile1-cs-LC83\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L84\" class=\"blob-num js-line-number\" data-line-number=\"84\"></td>\n        <td id=\"file-gistfile1-cs-LC84\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_READ_DATA<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_WRITE_DATA<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_APPEND_DATA<span class=\"pl-pds\">&quot;</span></span>,  <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_READ_EA<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L85\" class=\"blob-num js-line-number\" data-line-number=\"85\"></td>\n        <td id=\"file-gistfile1-cs-LC85\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_WRITE_EA<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_EXECUTE<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_DELETE_CHILD<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_READ_ATTRIBUTES<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L86\" class=\"blob-num js-line-number\" data-line-number=\"86\"></td>\n        <td id=\"file-gistfile1-cs-LC86\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>FILE_WRITE_ATTRIBUTES<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L87\" class=\"blob-num js-line-number\" data-line-number=\"87\"></td>\n        <td id=\"file-gistfile1-cs-LC87\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L88\" class=\"blob-num js-line-number\" data-line-number=\"88\"></td>\n        <td id=\"file-gistfile1-cs-LC88\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>DELETE <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>READ_CONTROL<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>WRITE_DAC<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>WRITE_OWNER<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L89\" class=\"blob-num js-line-number\" data-line-number=\"89\"></td>\n        <td id=\"file-gistfile1-cs-LC89\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SYNCHRONIZE <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L90\" class=\"blob-num js-line-number\" data-line-number=\"90\"></td>\n        <td id=\"file-gistfile1-cs-LC90\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ACCESS_SYSTEM_SECURITY<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>MAXIMUM_ALLOWED<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span> <span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L91\" class=\"blob-num js-line-number\" data-line-number=\"91\"></td>\n        <td id=\"file-gistfile1-cs-LC91\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GENERIC_ALL<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GENERIC_EXECUTE<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GENERIC_WRITE<span class=\"pl-pds\">&quot;</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>GENERIC_READ<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L92\" class=\"blob-num js-line-number\" data-line-number=\"92\"></td>\n        <td id=\"file-gistfile1-cs-LC92\" class=\"blob-code blob-code-inner js-file-line\">\t\t};</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L93\" class=\"blob-num js-line-number\" data-line-number=\"93\"></td>\n        <td id=\"file-gistfile1-cs-LC93\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L94\" class=\"blob-num js-line-number\" data-line-number=\"94\"></td>\n        <td id=\"file-gistfile1-cs-LC94\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">foreach</span> (<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">mbo</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">DaclObject</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L95\" class=\"blob-num js-line-number\" data-line-number=\"95\"></td>\n        <td id=\"file-gistfile1-cs-LC95\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L96\" class=\"blob-num js-line-number\" data-line-number=\"96\"></td>\n        <td id=\"file-gistfile1-cs-LC96\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>-------------------------------------------------<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L97\" class=\"blob-num js-line-number\" data-line-number=\"97\"></td>\n        <td id=\"file-gistfile1-cs-LC97\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>{0:X} - {1} - {2}<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AccessMask<span class=\"pl-pds\">&quot;</span></span>], <span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AceFlags<span class=\"pl-pds\">&quot;</span></span>], <span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AceType<span class=\"pl-pds\">&quot;</span></span>]);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L98\" class=\"blob-num js-line-number\" data-line-number=\"98\"></td>\n        <td id=\"file-gistfile1-cs-LC98\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L99\" class=\"blob-num js-line-number\" data-line-number=\"99\"></td>\n        <td id=\"file-gistfile1-cs-LC99\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Access allowed/denied ACE</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L100\" class=\"blob-num js-line-number\" data-line-number=\"100\"></td>\n        <td id=\"file-gistfile1-cs-LC100\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AceType<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-en\">ToString</span>() <span class=\"pl-k\">==</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1<span class=\"pl-pds\">&quot;</span></span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L101\" class=\"blob-num js-line-number\" data-line-number=\"101\"></td>\n        <td id=\"file-gistfile1-cs-LC101\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>DENIED ACE TYPE<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L102\" class=\"blob-num js-line-number\" data-line-number=\"102\"></td>\n        <td id=\"file-gistfile1-cs-LC102\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">else</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L103\" class=\"blob-num js-line-number\" data-line-number=\"103\"></td>\n        <td id=\"file-gistfile1-cs-LC103\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ALLOWED ACE TYPE<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L104\" class=\"blob-num js-line-number\" data-line-number=\"104\"></td>\n        <td id=\"file-gistfile1-cs-LC104\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L105\" class=\"blob-num js-line-number\" data-line-number=\"105\"></td>\n        <td id=\"file-gistfile1-cs-LC105\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Dump trustees</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L106\" class=\"blob-num js-line-number\" data-line-number=\"106\"></td>\n        <td id=\"file-gistfile1-cs-LC106\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">Trustee</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">ManagementBaseObject</span>)(<span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Trustee<span class=\"pl-pds\">&quot;</span></span>]));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L107\" class=\"blob-num js-line-number\" data-line-number=\"107\"></td>\n        <td id=\"file-gistfile1-cs-LC107\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Name: {0} - Domain: {1} - SID {2}<span class=\"pl-cce\">\\n</span><span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L108\" class=\"blob-num js-line-number\" data-line-number=\"108\"></td>\n        <td id=\"file-gistfile1-cs-LC108\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Trustee</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Name<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L109\" class=\"blob-num js-line-number\" data-line-number=\"109\"></td>\n        <td id=\"file-gistfile1-cs-LC109\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Trustee</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Domain<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L110\" class=\"blob-num js-line-number\" data-line-number=\"110\"></td>\n        <td id=\"file-gistfile1-cs-LC110\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Trustee</span>.<span class=\"pl-smi\">Properties</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SIDString<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L111\" class=\"blob-num js-line-number\" data-line-number=\"111\"></td>\n        <td id=\"file-gistfile1-cs-LC111\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L112\" class=\"blob-num js-line-number\" data-line-number=\"112\"></td>\n        <td id=\"file-gistfile1-cs-LC112\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> Dump ACE mask in readable form</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L113\" class=\"blob-num js-line-number\" data-line-number=\"113\"></td>\n        <td id=\"file-gistfile1-cs-LC113\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-en\">UInt32</span> <span class=\"pl-smi\">mask</span> <span class=\"pl-k\">=</span> (<span class=\"pl-en\">UInt32</span>)<span class=\"pl-smi\">mbo</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>AccessMask<span class=\"pl-pds\">&quot;</span></span>];</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L114\" class=\"blob-num js-line-number\" data-line-number=\"114\"></td>\n        <td id=\"file-gistfile1-cs-LC114\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L115\" class=\"blob-num js-line-number\" data-line-number=\"115\"></td>\n        <td id=\"file-gistfile1-cs-LC115\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> using enum formatting (see emumerating the possibilities.doc)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L116\" class=\"blob-num js-line-number\" data-line-number=\"116\"></td>\n        <td id=\"file-gistfile1-cs-LC116\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">System</span>.<span class=\"pl-smi\">Enum</span>.<span class=\"pl-en\">Format</span>(<span class=\"pl-k\">typeof</span>(<span class=\"pl-en\">Mask</span>), <span class=\"pl-smi\">mask</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>g<span class=\"pl-pds\">&quot;</span></span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L117\" class=\"blob-num js-line-number\" data-line-number=\"117\"></td>\n        <td id=\"file-gistfile1-cs-LC117\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L118\" class=\"blob-num js-line-number\" data-line-number=\"118\"></td>\n        <td id=\"file-gistfile1-cs-LC118\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L119\" class=\"blob-num js-line-number\" data-line-number=\"119\"></td>\n        <td id=\"file-gistfile1-cs-LC119\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L120\" class=\"blob-num js-line-number\" data-line-number=\"120\"></td>\n        <td id=\"file-gistfile1-cs-LC120\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">DumpGroup</span>(<span class=\"pl-en\">ManagementBaseObject</span> <span class=\"pl-smi\">Groups</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L121\" class=\"blob-num js-line-number\" data-line-number=\"121\"></td>\n        <td id=\"file-gistfile1-cs-LC121\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L122\" class=\"blob-num js-line-number\" data-line-number=\"122\"></td>\n        <td id=\"file-gistfile1-cs-LC122\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">Groups</span> <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L123\" class=\"blob-num js-line-number\" data-line-number=\"123\"></td>\n        <td id=\"file-gistfile1-cs-LC123\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L124\" class=\"blob-num js-line-number\" data-line-number=\"124\"></td>\n        <td id=\"file-gistfile1-cs-LC124\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>=======================================<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L125\" class=\"blob-num js-line-number\" data-line-number=\"125\"></td>\n        <td id=\"file-gistfile1-cs-LC125\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Group property count : <span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-k\">+</span> <span class=\"pl-smi\">Groups</span>.<span class=\"pl-smi\">Properties</span>.<span class=\"pl-smi\">Count</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L126\" class=\"blob-num js-line-number\" data-line-number=\"126\"></td>\n        <td id=\"file-gistfile1-cs-LC126\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">foreach</span> (<span class=\"pl-en\">PropertyData</span> <span class=\"pl-smi\">gd</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">Groups</span>.<span class=\"pl-smi\">Properties</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L127\" class=\"blob-num js-line-number\" data-line-number=\"127\"></td>\n        <td id=\"file-gistfile1-cs-LC127\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">gd</span>.<span class=\"pl-smi\">Name</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span><span class=\"pl-cce\">\\t\\t</span> <span class=\"pl-pds\">&quot;</span></span> <span class=\"pl-k\">+</span> <span class=\"pl-smi\">gd</span>.<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L128\" class=\"blob-num js-line-number\" data-line-number=\"128\"></td>\n        <td id=\"file-gistfile1-cs-LC128\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L129\" class=\"blob-num js-line-number\" data-line-number=\"129\"></td>\n        <td id=\"file-gistfile1-cs-LC129\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">else</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L130\" class=\"blob-num js-line-number\" data-line-number=\"130\"></td>\n        <td id=\"file-gistfile1-cs-LC130\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>NO GROUPS Properties <span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L131\" class=\"blob-num js-line-number\" data-line-number=\"131\"></td>\n        <td id=\"file-gistfile1-cs-LC131\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L132\" class=\"blob-num js-line-number\" data-line-number=\"132\"></td>\n        <td id=\"file-gistfile1-cs-LC132\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L133\" class=\"blob-num js-line-number\" data-line-number=\"133\"></td>\n        <td id=\"file-gistfile1-cs-LC133\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">DumpSacl</span>(<span class=\"pl-en\">ManagementBaseObject</span>[] <span class=\"pl-smi\">SaclObject</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L134\" class=\"blob-num js-line-number\" data-line-number=\"134\"></td>\n        <td id=\"file-gistfile1-cs-LC134\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L135\" class=\"blob-num js-line-number\" data-line-number=\"135\"></td>\n        <td id=\"file-gistfile1-cs-LC135\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">SaclObject</span> <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L136\" class=\"blob-num js-line-number\" data-line-number=\"136\"></td>\n        <td id=\"file-gistfile1-cs-LC136\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>No SACLs<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L137\" class=\"blob-num js-line-number\" data-line-number=\"137\"></td>\n        <td id=\"file-gistfile1-cs-LC137\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L138\" class=\"blob-num js-line-number\" data-line-number=\"138\"></td>\n        <td id=\"file-gistfile1-cs-LC138\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L139\" class=\"blob-num js-line-number\" data-line-number=\"139\"></td>\n        <td id=\"file-gistfile1-cs-LC139\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">DumpOwnerProperties</span>(<span class=\"pl-en\">PropertyDataCollection</span> <span class=\"pl-smi\">Owner</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L140\" class=\"blob-num js-line-number\" data-line-number=\"140\"></td>\n        <td id=\"file-gistfile1-cs-LC140\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L141\" class=\"blob-num js-line-number\" data-line-number=\"141\"></td>\n        <td id=\"file-gistfile1-cs-LC141\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>=============== Owner Properties ========================<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L142\" class=\"blob-num js-line-number\" data-line-number=\"142\"></td>\n        <td id=\"file-gistfile1-cs-LC142\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L143\" class=\"blob-num js-line-number\" data-line-number=\"143\"></td>\n        <td id=\"file-gistfile1-cs-LC143\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Domain {0} <span class=\"pl-cce\">\\t</span>Name {1}<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">Owner</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Domain<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>, <span class=\"pl-smi\">Owner</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Name<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L144\" class=\"blob-num js-line-number\" data-line-number=\"144\"></td>\n        <td id=\"file-gistfile1-cs-LC144\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">Console</span>.<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SID <span class=\"pl-cce\">\\t</span>{0}<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-smi\">Owner</span>[<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>SidString<span class=\"pl-pds\">&quot;</span></span>].<span class=\"pl-smi\">Value</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L145\" class=\"blob-num js-line-number\" data-line-number=\"145\"></td>\n        <td id=\"file-gistfile1-cs-LC145\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L146\" class=\"blob-num js-line-number\" data-line-number=\"146\"></td>\n        <td id=\"file-gistfile1-cs-LC146\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4953130/raw/eaea6444426e8e347d99868bd2d1e475fa960da1/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4953130#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>","frontmatter":{"title":"Listing Windows users and groups in C#","date":"April 16, 2010","description":"One method of listing Windows users and groups in C#."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2010-04-16-listing-windows-users-and-groups-in-c/","previous":{"fields":{"slug":"/2010-04-07-syntax-highlighter-for-csharp/"},"frontmatter":{"title":"Syntax highlighter for C#"}},"next":{"fields":{"slug":"/2010-05-03-delegates-funcs-and-actions-by-example/"},"frontmatter":{"title":"Delegates, Funcs and Actions by example"}}}}
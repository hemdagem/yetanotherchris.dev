{"data":{"site":{"siteMetadata":{"title":"Another Chris","author":"Chris Small"}},"markdownRemark":{"id":"d3882df7-ce82-582b-afc8-eeb8ee1f0c27","excerpt":"A look at the difference between these 4 interfaces, used for sorting and comparisons. IComparer This is used for custom sorting of objects. Prior to .NET 3.…","html":"<p>A look at the difference between these 4 interfaces, used for sorting and comparisons.</p>\n<h2>IComparer</h2>\n<p>This is used for custom sorting of objects. Prior to .NET 3.5 it was used primarily for Array.Sort but now finds itself used for sorting with LINQ. It has several default implementations including (as the MSDN page says) Comparer, CaseInsensitiveComparer. When implementing the interface, there is one method to fill:</p>\n<pre>int Compare(Object x,Object y)\nReturns:\nx &lt; y       -1\nx == y      0\nx &gt; y       1\n</pre>\n<!--more-->\n<p>IComparer<T> allows you to specialise the comparison by type. </p>\n<h3>Using IComparer <T> with C# 3.0 closures</h3>\n<p>With the introduction of closures in C# 3.0, you can now shorten your code with IComparer<T> and sorting. Here’s an example with sorting items in N2:</p>\n<p><div id=\"gist4757270\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">List</span>&lt;<span class=\"pl-en\">ContentItem</span>&gt; <span class=\"pl-smi\">list</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">N2</span>.<span class=\"pl-smi\">Context</span>.<span class=\"pl-smi\">CurrentPage</span>.<span class=\"pl-smi\">Children</span>.<span class=\"pl-en\">ToList</span>&lt;<span class=\"pl-en\">ContentItem</span>&gt;();</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">list</span>.<span class=\"pl-en\">Sort</span>(<span class=\"pl-k\">delegate</span>(<span class=\"pl-en\">ContentItem</span> <span class=\"pl-smi\">x</span>, <span class=\"pl-en\">ContentItem</span> <span class=\"pl-smi\">y</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">string</span>.<span class=\"pl-en\">IsNullOrEmpty</span>(<span class=\"pl-smi\">x</span>.<span class=\"pl-smi\">Title</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">1</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">else</span> <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">string</span>.<span class=\"pl-en\">IsNullOrEmpty</span>(<span class=\"pl-smi\">y</span>.<span class=\"pl-smi\">Title</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-k\">-</span><span class=\"pl-c1\">1</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-gistfile1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">x</span>.<span class=\"pl-smi\">Title</span>.<span class=\"pl-en\">CompareTo</span>(<span class=\"pl-smi\">y</span>.<span class=\"pl-smi\">Title</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-gistfile1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4757270/raw/804d7fffdd54a6e0180a87f02d115d27e5b1a353/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4757270#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>IComparable</h2>\n<p>IComparable gives you one method to implement: </p>\n<pre>int CompareTo(Object obj)</pre>\n<p>The same return value system applies as IComparer. The difference between this and IComparer is IComparable will be implemented on the class that contains your field values, while IComparable derived classes are used for custom sorting. So for example:</p>\n<p><div id=\"gist4757276\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">User</span> : <span class=\"pl-en\">IComparable</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">int</span> <span class=\"pl-en\">CompareTo</span>(<span class=\"pl-en\">Object</span> <span class=\"pl-smi\">obj</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">    {</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> comparison code here</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4757276/raw/a80b6eb36e0881345d9564d27cee40a283314587/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4757276#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>The CompareTo method would be the default way of ordering your User class, perhaps comparing by Name. If you then decided that you wanted to sort a list of User objects by another property, say Age, you could write a class that implemented IComparer instead of altering CompareTo inside User. This would perform the custom sorting, for example: </p>\n<p><div id=\"gist4757292\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">UserAgeComparer</span> : <span class=\"pl-en\">IComparer</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">int</span> <span class=\"pl-en\">CompareTo</span>(<span class=\"pl-en\">Object</span> <span class=\"pl-smi\">x</span>, <span class=\"pl-en\">Object</span> <span class=\"pl-smi\">y</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">User</span> <span class=\"pl-smi\">userX</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">x</span> <span class=\"pl-k\">as</span> <span class=\"pl-en\">User</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">User</span> <span class=\"pl-smi\">userY</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">y</span> <span class=\"pl-k\">as</span> <span class=\"pl-en\">User</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">userX</span> <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span> <span class=\"pl-k\">&amp;</span> <span class=\"pl-smi\">userY</span> <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-gistfile1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-gistfile1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> compare the age.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-gistfile1-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-gistfile1-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">else</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-gistfile1-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-gistfile1-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">0</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-gistfile1-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-gistfile1-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-gistfile1-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4757292/raw/bc9f8bd0bf8fd24435a9c2eaa000c31434126414/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4757292#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>As with IComparer you can specialise the comparison by implementing IComparable&#x3C;Tgt;.</p>\n<h2>Equals</h2>\n<p>Besides object comparison, Equals is also used in a few common collection methods. IndexOf(), Contains() both use the Equals() method for equality comparisons. This extends even further with .NET 3.5 and the inclusion of LINQ into the equation, where Equals is used frequently for comparion which leading to… </p>\n<h2>IEquatable<T></h2>\n<p>This interface was added in .NET 2.0. Its primary use is with value types to avoid the use of ValueType.Equals() (which all structs automatically use if Equals isn’t overriden). ValueType.Equals uses reflection to iterate through every field in the struct, checking for equality. If they are all equal to the object passed then true is returned (see the source further on in the article). Implementing IEquatable&#x3C;Tgt; only does a comparion between your object and &#x3C;Tgt; which is most likely to be the same type. This is performed frequently with the new methods brought in alongside LINQ in 3.5. Overriding Equals() from ValueType will do a check for any object type, and it’s recommended this is overridden with any custom value type alongside implementing IEquatable&#x3C;Tgt;. </p>\n<h2>IEqualityComparer<T></h2>\n<p>This interface, also added in 2.0, allows you to pass custom object equality checking to a Hashtable, Dictionary and NameValueCollection. You pass in your custom comparison implementation much like you do with IComparer and the Hashtable will use this for equality checks. This is done inside the constructor.</p>","frontmatter":{"title":"IComparable, IComparer, Equals, IEquatable&lt;T&gt;, IEqualityComparer","date":"September 27, 2009","description":"A look at the difference between these 4 interfaces, used for sorting and comparisons."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2009-09-27-icomparable-icomparer-equals-iequatablet-iequalitycomparer/","previous":{"fields":{"slug":"/2009-09-09-a-look-at-net-orms-part-1/"},"frontmatter":{"title":"A Look At .NET ORMs - Part 1"}},"next":{"fields":{"slug":"/2009-10-12-ldapactive-directory-tree-in-csharp/"},"frontmatter":{"title":"LDAP/Active directory tree in C#"}}}}
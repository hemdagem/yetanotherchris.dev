{"data":{"site":{"siteMetadata":{"title":"Another Chris","author":"Chris Small"}},"markdownRemark":{"id":"ceb6b7cf-ea61-5acc-aa12-a77bb3432e59","excerpt":"Most C# books will tell you from the early chapters that you should always override Equals in your class instead of relying on the base Object.Equals. As…","html":"<p>Most C# books will tell you from the early chapters that you should always override Equals in your class instead of relying on the base Object.Equals. As mentioned a few times previously, this is essential for value types as the base ValueType.Equals() method (which overrides Object.Equals) uses reflection to decide whether two objects are equal, comparing the field values. The source code for ValueType.Equals (from the Shared Source CLI) is shown below. </p>\n<!--more-->\n<p><div id=\"gist4952780\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">override</span> <span class=\"pl-k\">bool</span> <span class=\"pl-en\">Equals</span>(<span class=\"pl-k\">object</span> <span class=\"pl-smi\">obj</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">obj</span> <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">RuntimeType</span> <span class=\"pl-smi\">type</span> <span class=\"pl-k\">=</span> (<span class=\"pl-en\">RuntimeType</span>)<span class=\"pl-k\">base</span>.<span class=\"pl-en\">GetType</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-gistfile1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">RuntimeType</span> <span class=\"pl-smi\">type2</span> <span class=\"pl-k\">=</span> (<span class=\"pl-en\">RuntimeType</span>)<span class=\"pl-smi\">obj</span>.<span class=\"pl-en\">GetType</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-gistfile1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">type2</span> <span class=\"pl-k\">!=</span> <span class=\"pl-smi\">type</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-gistfile1-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-gistfile1-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-gistfile1-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-gistfile1-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">object</span> <span class=\"pl-smi\">a</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">this</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-gistfile1-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-en\">CanCompareBits</span>(<span class=\"pl-k\">this</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-gistfile1-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-gistfile1-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-en\">FastEqualsCheck</span>(<span class=\"pl-smi\">a</span>, <span class=\"pl-smi\">obj</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-gistfile1-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-gistfile1-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-gistfile1-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">FieldInfo</span>[] <span class=\"pl-smi\">fields</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">type</span>.<span class=\"pl-en\">GetFields</span>(<span class=\"pl-smi\">BindingFlags</span>.<span class=\"pl-smi\">NonPublic</span> <span class=\"pl-k\">|</span> <span class=\"pl-smi\">BindingFlags</span>.<span class=\"pl-smi\">Public</span> <span class=\"pl-k\">|</span> <span class=\"pl-smi\">BindingFlags</span>.<span class=\"pl-smi\">Instance</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-gistfile1-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">for</span> (<span class=\"pl-k\">int</span> <span class=\"pl-smi\">i</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0</span>; <span class=\"pl-smi\">i</span> <span class=\"pl-k\">&lt;</span> <span class=\"pl-smi\">fields</span>.<span class=\"pl-smi\">Length</span>; <span class=\"pl-smi\">i</span><span class=\"pl-k\">++</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-gistfile1-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-gistfile1-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">object</span> <span class=\"pl-smi\">obj3</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">RtFieldInfo</span>)<span class=\"pl-smi\">fields</span>[<span class=\"pl-smi\">i</span>]).<span class=\"pl-en\">InternalGetValue</span>(<span class=\"pl-smi\">a</span>, <span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-gistfile1-cs-LC23\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">object</span> <span class=\"pl-smi\">obj4</span> <span class=\"pl-k\">=</span> ((<span class=\"pl-en\">RtFieldInfo</span>)<span class=\"pl-smi\">fields</span>[<span class=\"pl-smi\">i</span>]).<span class=\"pl-en\">InternalGetValue</span>(<span class=\"pl-smi\">obj</span>, <span class=\"pl-c1\">false</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-gistfile1-cs-LC24\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">obj3</span> <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-gistfile1-cs-LC25\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-gistfile1-cs-LC26\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">obj4</span> <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-gistfile1-cs-LC27\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-gistfile1-cs-LC28\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-gistfile1-cs-LC29\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-gistfile1-cs-LC30\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-gistfile1-cs-LC31\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">else</span> <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">obj3</span>.<span class=\"pl-en\">Equals</span>(<span class=\"pl-smi\">obj4</span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-gistfile1-cs-LC32\" class=\"blob-code blob-code-inner js-file-line\">\t\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-gistfile1-cs-LC33\" class=\"blob-code blob-code-inner js-file-line\">\t\t\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-gistfile1-cs-LC34\" class=\"blob-code blob-code-inner js-file-line\">\t\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-gistfile1-cs-LC35\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-gistfile1-cs-LC36\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">return</span> <span class=\"pl-c1\">true</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-gistfile1-cs-LC37\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4952780/raw/3141b5580f2ba0aef496f0163f5b1ec4eaa9c70a/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4952780#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>For reference types, the base Object.Equals() method does a call to an internal method as its signature shows:</p>\n<pre>public virtual bool Equals(object obj)\n{\n\treturn InternalEquals(this, obj);\n}\n\n[MethodImpl(MethodImplOptions.InternalCall)]\ninternal static extern bool InternalEquals(object objA, object objB);\n</pre>\n<p>This InternalEquals method can be found in the CLR VM source code <a href=\"http://www.koders.com/cpp/fid191D8DC42DC6E980F49546893D6E3243A04AB1B1.aspx?s=InternalEquals\">here</a>, or if you prefer to download the source, it’s at <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=8C09FD61-3F26-4555-AE17-3121B4F51D4D&#x26;displaylang=en\">Shared Source CLI 2.0</a>. </p>\n<p>Assuming you know some basic C++, you can see from the InternalEquals source that all sanity checks are done inside the VM rather than the Object.Equals() source show above. These include checking both types aren’t null, checking they’re the same type (using a method table lookup). The memory addresses of the two reference types are then compared, returning true or false. </p>\n<p>For reference types that don’t perform operator overloading, == will check whether its memory address is equal to the 2nd object. ReferenceEquals() performs the same task to this. The MSDN docs describe how “To check for reference equality, use ReferenceEquals. To check for value equality, use Equals.”. This is a bit contradictory as the Object.Equals() method checks for reference equality, so reference types that don’t override Equals() will be checking for reference equality by default. </p>\n<p>With String.Equals(), the String class has overridden Object.Equals() so that it does its own comparison checking instead of the default reference check: </p>\n<pre>public override bool Equals(object obj)\n{\n\tstring strB = obj as string;\n\tif ((strB == null) &#038;&#038; (this != null))\n\t{\n\t\treturn false;\n\t}\n\treturn EqualsHelper(this, strB);\n}</pre>\n<p><a href=\"http://www.koders.com/csharp/fid6135F77482E6125D97DC3197AD53876AE1098662.aspx?s=EqualsHelper\">EqualsHelper</a> is the internal method that determines if two strings are the same. This use to be inside the VM source in 1.1, but has since been moved into the BCL source code. The first check it does is to determine if they are the same length, returning false if they’re not. After this it checks each character (in blocks of 10, working backwards on the string) 2 bytes at a time (i.e. a single character in Unicode). </p>\n<p>The String class also overrides the == and != operators: </p>\n<pre>public static bool operator ==(string a, string b)\n{\n\treturn Equals(a, b);\n}\n</pre>\n<p>Now say you do the check on two Unicode strings that don’t use the default Western ISO 1252 codepage (the default on Windows US/UK installs): </p>\n<pre>string a = \"Unicode text 1\";\nstring b = \"Unicode text 2\";\nif ( a == b )\n\tConsole.WriteLine(\"Equal from ==\");\nif ( a.Equals(b) )\n\tConsole.WriteLine(\"Equals from Equals()\");\n</pre>\n<p>Equals() does a 2 byte Unicode lookup (strings are stored in Unicode format internally in .NET). I’ve heard or read in the past that “equals is faster than ==”. Here’s the IL from above: </p>\n<p><div id=\"gist4952840\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-gistfile1-cs\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-c \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-gistfile1-cs-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-gistfile1-cs-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0000</span>: <span class=\"pl-smi\">nop</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-gistfile1-cs-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0001</span>: <span class=\"pl-smi\">ldstr</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Unicode text 1<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-gistfile1-cs-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0006</span>: <span class=\"pl-smi\">stloc</span><span class=\"pl-c1\">.0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-gistfile1-cs-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0007</span>: <span class=\"pl-smi\">ldstr</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Unicode text 2<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-gistfile1-cs-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_000c</span>: <span class=\"pl-smi\">stloc</span><span class=\"pl-c1\">.1</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-gistfile1-cs-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_000d</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-gistfile1-cs-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_000e</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.1</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-gistfile1-cs-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_000f</span>: <span class=\"pl-smi\">call</span> <span class=\"pl-smi\">bool</span> [<span class=\"pl-smi\">mscorlib</span>]<span class=\"pl-smi\">System</span>.<span class=\"pl-smi\">String</span>::<span class=\"pl-en\">op_Equality</span>(<span class=\"pl-smi\">string</span>,<span class=\"pl-smi\">string</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-gistfile1-cs-LC9\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0014</span>: <span class=\"pl-smi\">ldc</span>.<span class=\"pl-smi\">i4</span><span class=\"pl-c1\">.0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-gistfile1-cs-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0015</span>: <span class=\"pl-smi\">ceq</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-gistfile1-cs-LC11\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0017</span>: <span class=\"pl-smi\">stloc</span><span class=\"pl-c1\">.2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-gistfile1-cs-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0018</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-gistfile1-cs-LC13\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0019</span>: <span class=\"pl-smi\">brtrue</span>.<span class=\"pl-smi\">s</span> <span class=\"pl-smi\">IL_0026</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-gistfile1-cs-LC14\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_001b</span>: <span class=\"pl-smi\">ldstr</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Equal from ==<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-gistfile1-cs-LC15\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0020</span>: <span class=\"pl-smi\">call</span> <span class=\"pl-smi\">void</span> [<span class=\"pl-smi\">mscorlib</span>]<span class=\"pl-smi\">System</span>.<span class=\"pl-smi\">Console</span>::<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">string</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-gistfile1-cs-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0025</span>: <span class=\"pl-smi\">nop</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-gistfile1-cs-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0026</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-gistfile1-cs-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0027</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.1</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-gistfile1-cs-LC19\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0028</span>: <span class=\"pl-smi\">callvirt</span> <span class=\"pl-smi\">instance</span> <span class=\"pl-smi\">bool</span> [<span class=\"pl-smi\">mscorlib</span>]<span class=\"pl-smi\">System</span>.<span class=\"pl-smi\">String</span>::<span class=\"pl-en\">Equals</span>(<span class=\"pl-smi\">string</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-gistfile1-cs-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_002d</span>: <span class=\"pl-smi\">ldc</span>.<span class=\"pl-smi\">i4</span><span class=\"pl-c1\">.0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-gistfile1-cs-LC21\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_002e</span>: <span class=\"pl-smi\">ceq</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-gistfile1-cs-LC22\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0030</span>: <span class=\"pl-smi\">stloc</span><span class=\"pl-c1\">.2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-gistfile1-cs-LC23\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0031</span>: <span class=\"pl-smi\">ldloc</span><span class=\"pl-c1\">.2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-gistfile1-cs-LC24\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0032</span>: <span class=\"pl-smi\">brtrue</span>.<span class=\"pl-smi\">s</span> <span class=\"pl-smi\">IL_003f</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-gistfile1-cs-LC25\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0034</span>: <span class=\"pl-smi\">ldstr</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Equals from Equals()<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-gistfile1-cs-LC26\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_0039</span>: <span class=\"pl-smi\">call</span> <span class=\"pl-smi\">void</span> [<span class=\"pl-smi\">mscorlib</span>]<span class=\"pl-smi\">System</span>.<span class=\"pl-smi\">Console</span>::<span class=\"pl-en\">WriteLine</span>(<span class=\"pl-smi\">string</span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-gistfile1-cs-LC27\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_003e</span>: <span class=\"pl-smi\">nop</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-gistfile1-cs-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-gistfile1-cs-LC28\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">IL_003f</span>: <span class=\"pl-smi\">ret</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/yetanotherchris/4952840/raw/9adec90f8285b6e24914f6342fbd5443dc372e19/gistfile1.cs\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/yetanotherchris/4952840#file-gistfile1-cs\">gistfile1.cs</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>Is it really faster/more optimised to call Equals()? The code above shows that it’s one less method on the stack so arguably yes. The speed difference is unlikely to be noticeable in 99% of applications, and I prefer, and always will use == unless asked not to. But it’s down to preference of the programmer, and what languages have influenced them in the past. There is an argument that says you should always use Equals as it describes to other programmers exactly what type of comparison you are doing (ordinal case-insensitive), which I can see I still prefer == though. </p>\n<p>MSDN describes what == does (or the Equals method it calls): </p>\n<blockquote>\n<p>This method performs an ordinal (case-sensitive and culture-insensitive) comparison.</p>\n</blockquote>\n<p>When would you ever need a non-ordinal (the numeric value of the character) comparison, i.e. String.Compare instead of == or Equals()? Inside a method that uses sorting, for example an IComparer implementation. Sorting è,é,ê and ë for is one example. The Equals() method in comparison is more suited to checking your internal strings such as filenames, resource names, database connection strings.</p>","frontmatter":{"title":"String.Equals(), == and String.Compare()","date":"March 02, 2010","description":"What's the difference between ==, .equals and string.Compare()? This post explores the three ways of comparing strings in C#/.NET."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2010-03-02-string-equals-and-string-compare/","previous":{"fields":{"slug":"/2010-02-18-printing-all-tables-in-a-database-with-management-smo/"},"frontmatter":{"title":"Printing all tables in a database with Management.Smo"}},"next":{"fields":{"slug":"/2010-03-16-using-google-maps-with-csharp/"},"frontmatter":{"title":"Using Google maps with C#"}}}}